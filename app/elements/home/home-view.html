<dom-module id="home-view">
    <template>
        <style>
            :host {
                display: block;
            }
            paper-material {
                background: var(--primary-background-color);
                color: var(--primary-text-color);
            }

            .header {
                color: var(--primary-text-color);
            }

            .stack {
                margin: 15px auto;
            }

            iron-image {
                --iron-image-width: 100%;
            }

            img {
                display: block;
                transform: translate3d(-50%, 596px, 0px);
            }

            .home {
                /*height: 1000px;*/
            }

            h3, h5 {
                color: var(--light-primary-color);
            }

            h1 {
                margin: 0px;
            }

            #about {
                opacity: 0;
                margin-bottom: 0px;
                background-color: var(--light-primary-color);
            }

            paper-progress {
                --paper-progress-transition-duration: 0.08s;
                --paper-progress-transition-timing-function: ease;
                --paper-progress-transition-transition-delay: 1s;
            }

            #contact {
                color: var(--dark-primary-color);
                margin-bottom: 0px;
            }

            .light, .light > a {
                color: var(--dark-primary-color);
            }

            form {
                margin-bottom: 20px;
            }

            .social-icons {
                width: 40px;
                height: 40px;
            }

            #cont {
                /*position: absolute;*/
                /*position: absolute;*/
                /*top: 0; right: 0; bottom: 0; left: 0;*/
            }

            #cap img{
                opacity: 0.1;
                min-width:  70%;
            }
        </style>
        <div class="parallax-container home valign-wrapper" id="cont">
            <div class="parallax" id="parallax">
                <img src="/images/home-bg.jpg">
            </div>
            <div class="container center">
                <iron-image src="{{profile.avatar_nocap}}" style="width:135px; height: 135px;" class="circle responsive-img" preload ></iron-image>
                <h3>{{profile.name}}</h3>
                <h5>Web Developer</h5>
                <paper-spinner active="{{showLoading}}"></paper-spinner>
            </div>
        </div>

        <div class="section" id="about">
            <div class="row container">
                <h2 class="header">Web Development</h2>
                <p>{{profile.intro}}</p>
            </div>
        </div>

        <my-portfolio profile="{{profile}}"></my-portfolio>

        <my-skill profile="{{profile}}" id="skill" hidden="{{!showAbout}}"></my-skill>

        <div class="row container center">
            <h2 class="header"> Todo App in Google's Polymer</h2>
            <div class="col s12">
                <todo-data todos="{{todos}}"></todo-data>
                <todo-view todos="{{todos}}"></todo-view>
            </div>
        </div>
        <iron-request id="xhr"></iron-request>
        <div class="parallax-container home valign-wrapper" id="contact">
            <div class="parallax" id="cap">
                <img src="/images/plain.png">
            </div>
            <div class="container center">
                <h2>Contact</h2>
                <div hidden="{{feedback}}">
                    <div class="input-field">
                          <input id="email" type="text" class="validate">
                          <label for="email">Email</label>
                    </div>
                    <div class="input-field">
                      <textarea id="textarea1" class="materialize-textarea"></textarea>
                      <label for="textarea1">Message</label>
                    </div>

                    <div class="input-field">
                        <paper-button on-click="_checkAdd">Submit</paper-button>
                    </div>
                </div>
                <h2 class="header">{{feedback}}</h2>
                <p class="light">
                    {{profile.name}}<br>
                    <iron-icon icon="maps:mail"></iron-icon>{{profile.email}}<br>
                    <iron-icon icon="maps:add-location"></iron-icon>{{profile.location}}</i><br>
                    <a href="{{profile.github}}"><iron-icon class="social-icons" icon="my-icons:github-square"></iron-icon></i></a>
                    <a href="{{profile.facebook}}"><iron-icon class="social-icons" icon="my-icons:facebook-square"></iron-icon></a>
                    <a href="{{profile.linkedin}}"><iron-icon class="social-icons" icon="my-icons:linkedin-square"></iron-icon></a>
                    <a href="{{profile.twitter}}"><iron-icon class="social-icons" icon="my-icons:twitter-square"></iron-icon></i></a>
                    <a href="{{profile.instagram}}"><iron-icon class="social-icons" icon="my-icons:instagram"></iron-icon></a>
                </p>
            </div>
        </div>

        <iron-signals on-iron-signal-scroll="scrolled"></iron-signals>
    </template>
    <script>
        Polymer({
            is: 'home-view',
            behaviors: [
                Polymer.NeonAnimationRunnerBehavior
            ],
            // properties: {
            //     feedback: String,
            //     route: {
            //         observer: 'routeChanged'
            //     }
            // },
            properties: {
                route: {
                    observer: 'routeChanged'
                },
                feedback: {type:String, value: ''},
                showLoading: {
                    type: Boolean,
                    computed: 'getUser(profile)'
                },
                animationConfig: {
                    value: function() {
                        return {
                            'entry': {
                                name: 'slide-from-left-animation',
                                node: this.$.about,
                            },
                            'flash': {
                                name: 'fade-in-animation',
                                node: this.$.cont,
                                timing: {
                                    delay: 500
                                }
                            },
                            'exit': {
                                name: 'fade-out-animation',
                                node: this.$.image
                            }
                        };
                    }
                },
                showContact: {
                    type: Boolean,
                    value: !false
                },
                showAbout: {
                    type: Boolean,
                    value: false
                }
            },
            listeners: {
                'scroll': 'scrolled',
                'neon-animation-finish': '_onNeonAnimationFinish'
            },
            scrolled: function (e) {
                if (e.detail.scrollTop >= 250) {
                    this.$.about.style.opacity = 1
                    if (!this.showAbout) {
                        this.showAbout = true;
                        this.playAnimation('entry');
                    }
                }
            },
            _checkAdd: function (e) {
                var _this = this;

                if (!this.$.textarea1.value && !this.$.email.value) {
                    return;
                }

                this.$.xhr.send({
                    url: 'https://message-9e565.firebaseio.com/.json',
                    method: 'POST',
                    body: JSON.stringify({
                        name: this.$.email.value,
                        message: this.$.textarea1.value
                    })
                }).then(function () {
                    _this.feedback = 'Message Sent';
                });

                this.$.textarea1.value = '';
                this.$.email.value = '';

            },
            _onNeonAnimationFinish: function (e) {
                if (e.detail !== 'fade') {
                    this.$.about.style.opacity = 1;
                }
            },
            ready: function () {
                var height = window.innerHeight
                || document.documentElement.clientHeight
                || document.body.clientHeight;

                this.$.cont.style.height = height + 'px';
                this.$.contact.style.height = height + 'px';

            },
            routeChanged: function () {
                if (this.route === 'home') {
                    this.playAnimation('flash', 'fade');
                }
            },
            getUser: function (profile) {
                return !profile;
            }
        });
    </script>
</dom-module>