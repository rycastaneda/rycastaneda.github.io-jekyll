<link rel="import" href="/bower_components/polymer/polymer.html">

<dom-module id="todo-list">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>
        Task Done: <span>{{taskDone}}</span>
        Task Left: <span>{{taskLeft}}</span>
        <template is="dom-repeat" items="{{todos}}" as="todo" filter="{{filterState(filterSelection)}}" observe="isComplete filterSelection">
            <todo-item todo="{{todo}}" index="{{index}}"></todo-item>
        </template>
    </template>
    <script>
        Polymer({
            is: 'todo-list',
            properties: {
                taskDone: {
                    type: String,
                    computed: '_computeTaskDone(todos.*)',
                    notify: true
                },
                taskLeft: {
                    type: String,
                    computed: '_computeTaskLeft(todos.*)',
                    notify: true
                }
            },
            filterState : function (filterBy) {
                if (filterBy !== 'all') {
                    return function(item) {
                        return item.isComplete === (filterBy === 'done');
                    };
                }

                return function () {
                  return true;
                };
            },
            _computeTaskDone: function () {
                return this.todos.filter(function(e){
                    return e.isComplete;
                }).length;
            },
            _computeTaskLeft: function () {
                return this.todos.filter(function(e){
                    return !e.isComplete;
                }).length;
            }

        });
    </script>
</dom-module>